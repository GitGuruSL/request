<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Image URLs</title>
</head>
<body>
    <h1>Vehicle Image URL Test</h1>
    <div id="output"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyA9PVfpSYu6WoLKjQZyH-0oQjBjLQwwXzQ",
            authDomain: "request-marketplace.firebaseapp.com",
            projectId: "request-marketplace",
            storageBucket: "request-marketplace.firebasestorage.app",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function testImageUrls() {
            const output = document.getElementById('output');
            output.innerHTML = '<p>Loading driver data...</p>';

            try {
                const driversSnapshot = await getDocs(collection(db, 'drivers'));
                let results = '<h2>Driver Vehicle Image URLs:</h2>';

                driversSnapshot.forEach(doc => {
                    const data = doc.data();
                    results += `<h3>Driver: ${data.name || 'Unknown'} (ID: ${doc.id})</h3>`;
                    
                    if (data.vehicleImageUrls && data.vehicleImageUrls.length > 0) {
                        results += '<ul>';
                        data.vehicleImageUrls.forEach((url, index) => {
                            results += `
                                <li>
                                    <strong>Image ${index + 1}:</strong><br>
                                    <code>${url}</code><br>
                                    <img src="${url}" style="max-width: 200px; max-height: 150px; border: 1px solid #ccc; margin: 5px 0;" 
                                         onload="console.log('✅ Image ${index + 1} loaded:', '${url}')"
                                         onerror="console.error('❌ Image ${index + 1} failed:', '${url}'); this.style.border='2px solid red';">
                                    <br><small>Valid URL: ${url.startsWith('https://') ? '✅' : '❌'}</small>
                                </li>
                            `;
                        });
                        results += '</ul>';
                    } else {
                        results += '<p>No vehicle images found.</p>';
                    }
                    
                    results += '<hr>';
                });

                output.innerHTML = results;
            } catch (error) {
                console.error('Error:', error);
                output.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }

        // Run the test
        testImageUrls();
    </script>
</body>
</html>
