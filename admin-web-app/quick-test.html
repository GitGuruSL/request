<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Function Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <div class="card">
            <div class="card-header">
                <h3>üöÄ Quick Admin Function Test</h3>
            </div>
            <div class="card-body">
                <div id="results" class="mb-4"></div>
                
                <h5>Function Availability Check:</h5>
                <button class="btn btn-primary mb-2" onclick="checkFunctions()">Check Functions Now</button>
                
                <hr>
                <div>
                    <button class="btn btn-secondary" onclick="testAdminPanel()">
                        üîó Test Complete Admin Panel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const results = document.getElementById('results');
        
        function log(message, type = 'info') {
            const alertClass = type === 'error' ? 'alert-danger' : 
                              type === 'success' ? 'alert-success' : 
                              type === 'warning' ? 'alert-warning' : 'alert-info';
            
            results.innerHTML += `
                <div class="alert ${alertClass} alert-dismissible fade show" role="alert">
                    <small>${new Date().toLocaleTimeString()}</small>: ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
        }
        
        function checkFunctions() {
            results.innerHTML = ''; // Clear previous results
            log('üîç Testing admin panel functions...', 'info');
            
            // Open admin panel and test
            const adminWindow = window.open('complete-admin.html', 'admin-test');
            
            setTimeout(() => {
                try {
                    if (adminWindow && !adminWindow.closed) {
                        // Test showSection
                        if (typeof adminWindow.showSection === 'function') {
                            log('‚úÖ showSection is accessible', 'success');
                        } else if (typeof adminWindow.window?.showSection === 'function') {
                            log('‚úÖ window.showSection is accessible', 'success');
                        } else {
                            log('‚ùå showSection NOT accessible', 'error');
                        }
                        
                        // Test approveDocument
                        if (typeof adminWindow.approveDocument === 'function' || typeof adminWindow.window?.approveDocument === 'function') {
                            log('‚úÖ approveDocument is accessible', 'success');
                        } else {
                            log('‚ùå approveDocument NOT accessible', 'error');
                        }
                        
                        // Test rejectDocument
                        if (typeof adminWindow.rejectDocument === 'function' || typeof adminWindow.window?.rejectDocument === 'function') {
                            log('‚úÖ rejectDocument is accessible', 'success');
                        } else {
                            log('‚ùå rejectDocument NOT accessible', 'error');
                        }
                        
                        // Test viewDriver
                        if (typeof adminWindow.viewDriver === 'function' || typeof adminWindow.window?.viewDriver === 'function') {
                            log('‚úÖ viewDriver is accessible', 'success');
                        } else {
                            log('‚ùå viewDriver NOT accessible', 'error');
                        }
                        
                        // Check for JavaScript errors in console
                        try {
                            const errors = adminWindow.console?.errors || [];
                            if (errors.length > 0) {
                                log(`‚ö†Ô∏è ${errors.length} console errors detected`, 'warning');
                            } else {
                                log('‚úÖ No console errors detected', 'success');
                            }
                        } catch (e) {
                            log('‚ÑπÔ∏è Cannot access console errors', 'info');
                        }
                        
                        adminWindow.close();
                    } else {
                        log('‚ùå Could not open admin panel', 'error');
                    }
                } catch (e) {
                    log('‚ùå Error testing functions: ' + e.message, 'error');
                    if (adminWindow && !adminWindow.closed) {
                        adminWindow.close();
                    }
                }
            }, 3000); // Wait 3 seconds for page to load
        }
        
        function testAdminPanel() {
            window.open('complete-admin.html', '_blank');
        }
        
        // Auto-run test when page loads
        window.addEventListener('DOMContentLoaded', function() {
            log('üöÄ Quick test page loaded - Click "Check Functions Now" to test', 'info');
        });
    </script>
</body>
</html>
