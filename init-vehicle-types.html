<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Initialize Vehicle Types</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <h1>Initialize Vehicle Types</h1>
    <button onclick="addVehicleTypes()">Add Initial Vehicle Types</button>
    <div id="status"></div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyANF1gAM96h7K7GUJkN5MqjGO7dOL74qN8",
            authDomain: "request-users-app.firebaseapp.com",
            projectId: "request-users-app",
            storageBucket: "request-users-app.firebasestorage.app",
            messagingSenderId: "815587282897",
            appId: "1:815587282897:web:c4fab5d7c5b7db4b6a8b1a"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        async function addVehicleTypes() {
            const status = document.getElementById('status');
            status.innerHTML = 'Checking Firebase connection...';

            try {
                // Test Firebase connection first
                await db.collection('test').limit(1).get();
                status.innerHTML = 'Firebase connected. Adding vehicle types...';

                const vehicleTypes = [
                    {
                        name: 'Bike',
                        icon: 'TwoWheeler',
                        isActive: true,
                        displayOrder: 1,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        createdBy: 'system-init'
                    },
                    {
                        name: 'Three Wheeler',
                        icon: 'LocalTaxi',
                        isActive: true,
                        displayOrder: 2,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        createdBy: 'system-init'
                    },
                    {
                        name: 'Car',
                        icon: 'DirectionsCar',
                        isActive: true,
                        displayOrder: 3,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        createdBy: 'system-init'
                    },
                    {
                        name: 'Van',
                        icon: 'AirportShuttle',
                        isActive: true,
                        displayOrder: 4,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        createdBy: 'system-init'
                    },
                    {
                        name: 'Shared Ride',
                        icon: 'People',
                        isActive: true,
                        displayOrder: 5,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        createdBy: 'system-init'
                    }
                ];

                // Check if vehicle types already exist
                const existingVehicles = await db.collection('vehicle_types').limit(1).get();
                if (!existingVehicles.empty) {
                    status.innerHTML = '<p style="color: orange;">⚠️ Vehicle types already exist in database!</p>';
                    return;
                }

                let addedCount = 0;
                for (const vehicleType of vehicleTypes) {
                    try {
                        await db.collection('vehicle_types').add(vehicleType);
                        addedCount++;
                        status.innerHTML = `Adding vehicle types... (${addedCount}/${vehicleTypes.length})`;
                        console.log('Added vehicle type:', vehicleType.name);
                    } catch (error) {
                        console.error('Error adding vehicle type:', vehicleType.name, error);
                        status.innerHTML += `<br><span style="color: red;">Failed to add: ${vehicleType.name}</span>`;
                    }
                }
                
                if (addedCount === vehicleTypes.length) {
                    status.innerHTML = '<p style="color: green;">✅ All vehicle types added successfully!</p>';
                    status.innerHTML += '<p>Added: ' + vehicleTypes.map(v => v.name).join(', ') + '</p>';
                } else {
                    status.innerHTML += `<p style="color: orange;">⚠️ Added ${addedCount} out of ${vehicleTypes.length} vehicle types</p>`;
                }
                
            } catch (error) {
                console.error('Error:', error);
                status.innerHTML = '<p style="color: red;">❌ Error: ' + error.message + '</p>';
                status.innerHTML += '<p>Please check:</p>';
                status.innerHTML += '<ul>';
                status.innerHTML += '<li>Internet connection</li>';
                status.innerHTML += '<li>Firebase configuration</li>';
                status.innerHTML += '<li>Firestore rules allow writes</li>';
                status.innerHTML += '</ul>';
            }
        }
    </script>
</body>
</html>
